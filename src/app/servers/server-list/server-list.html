<div class="dashboard-wrapper">
  <div class="dashboard-header">
    <div>
      <h2 class="header-title">MCP Servers</h2>
      <p class="header-subtitle">
        Monitor the health of your Model Context Protocol servers in real time.
      </p>
      <div class="timestamp" *ngIf="lastRefreshed">
        Last refreshed at {{ lastRefreshed | date: 'shortTime' }}
      </div>
    </div>

    <div class="metrics">
      <span class="metric-pill online">Online: {{ onlineCount }}</span>
      <span class="metric-pill total">Total: {{ servers.length }}</span>
      <button
        pButton
        type="button"
        icon="pi pi-refresh"
        label="Refresh"
        class="p-button-rounded p-button-text p-button-plain"
        (click)="loadServers()"
        [disabled]="loading"
      ></button>
      <button
        pButton
        type="button"
        icon="pi pi-sign-out"
        label="Logout"
        class="p-button-danger"
        (click)="onLogout()"
      ></button>
    </div>
  </div>

  <p-card class="server-card">
    <div class="table-container">
      <p-table
        [value]="servers"
        responsiveLayout="scroll"
        [loading]="loading"
        class="server-table"
      >
        <ng-template pTemplate="header">
          <tr>
            <th>Server</th>
            <th>Command</th>
            <th>Status</th>
            <th>Working Directory</th>
            <th>Last Connected</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-server>
          <tr>
            <td>
              <span class="badge">{{ server.id || 'Unknown' }}</span>
            </td>
            <td>{{ server.config?.command || 'N/A' }}</td>
            <td>
              <span
                class="status-dot"
                [class.online]="server.connected"
                [class.offline]="!server.connected"
              ></span>
              {{ server.connected ? 'Connected' : 'Disconnected' }}
            </td>
            <td>{{ server.config?.workingDirectory || 'N/A' }}</td>
            <td>
              {{ server.lastConnected ? (server.lastConnected | date: 'medium') : 'Not available' }}
            </td>
          </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="5">
              <div class="empty-state">
                <i class="pi pi-server"></i>
                <p>No servers registered yet.</p>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>

      <div class="error-banner" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>
    </div>
  </p-card>
</div>



